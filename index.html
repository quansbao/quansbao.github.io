<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apple Intelligencee</title>
    <style>
        :root {
            --ai-gradient: linear-gradient(
                90deg,
                #ff3b30, #ff9500, #ffcc00, #34c759, #007aff, #5856d6, #af52de, #ff3b30
            );
            
            --ios-easing: cubic-bezier(0.23, 1, 0.32, 1);
            --liquid-easing: cubic-bezier(0.4, 0, 0.1, 1);
            --genie-easing: cubic-bezier(0.4, 0, 0, 1);
            
            --iphone-w: 360px; --iphone-h: 780px;
            --ipad-w: 700px; --ipad-h: 500px;
            --mac-w: 800px; --mac-h: 500px; 

            --imac-x: 0px;
            --imac-y: 0px;
            --imac-w: 340px;
            --imac-h: 180px;
        }

        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(-45deg, #000000, #1a0b2e, #0a1a2e, #000000);
            background-size: 400% 400%;
            animation: backgroundGradient 15s ease infinite;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            overflow: hidden;
            user-select: none;
        }

        @keyframes backgroundGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- Global Minimal Status Bar --- */
        .global-status-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 38px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 24px;
            font-size: 13px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            z-index: 5000;
            backdrop-filter: blur(30px);
            background: rgba(0, 0, 0, 0.15);
            border-bottom: 0.5px solid rgba(255, 255, 255, 0.08);
        }

        .ai-trigger-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 4px 12px;
            border-radius: 20px;
            transition: all 0.3s var(--ios-easing);
            background: rgba(255, 255, 255, 0);
        }
        
        .ai-trigger-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .ai-logo-glow {
            width: 18px;
            height: 18px;
            position: relative;
            background: var(--ai-gradient);
            background-size: 200% 200%;
            border-radius: 50%;
            animation: aurora-move 4s linear infinite;
            box-shadow: 0 0 10px rgba(88, 86, 214, 0.5);
        }

        .status-right { font-variant-numeric: tabular-nums; letter-spacing: 0.2px; opacity: 0.8; }

        .viewport {
            perspective: 1200px;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100vh;
            padding-top: 38px;
        }

        /* --- Device Wrapper --- */
        .device-wrapper {
            position: relative;
            z-index: 10;
            background: #121212;
            box-shadow: 0 0 0 1px #333, 0 40px 80px rgba(0,0,0,0.8);
            transition: 
                width 0.8s var(--ios-easing), 
                height 0.8s var(--ios-easing), 
                border-radius 0.8s, 
                transform 0.7s var(--genie-easing), 
                opacity 0.7s var(--genie-easing),
                filter 0.7s var(--genie-easing);
            transform-origin: bottom center;
            opacity: 1;
        }

        .device-wrapper.genie-hidden {
            transform: translateY(400px) scaleX(0.1) scaleY(0.01);
            opacity: 0;
            filter: blur(15px);
            pointer-events: none;
        }

        .device-wrapper.exit-left { transform: translateX(-120vw) scale(0.9); opacity: 0; }
        .device-wrapper.enter-right { transform: translateX(120vw) scale(0.9); opacity: 0; }

        .mode-iphone .device-wrapper { width: var(--iphone-w); height: var(--iphone-h); border-radius: 56px; padding: 12px; }
        .mode-ipad .device-wrapper { width: var(--ipad-w); height: var(--ipad-h); border-radius: 32px; padding: 12px; }
        .mode-macbook .device-wrapper { width: var(--mac-w); height: var(--mac-h); border-radius: 20px; padding: 12px; background: #1a1a1a; }
        .mode-imac .device-wrapper { width: var(--mac-w); height: calc(var(--mac-h) + 60px); background: #f5f5f7; border-radius: 24px; padding: 18px; padding-bottom: 0; }

        .screen-container {
            position: relative;
            width: 100%; height: 100%;
            background: #000;
            overflow: hidden;
            border-radius: inherit;
            display: flex; justify-content: center;
            background-image: url('https://quansbao.github.io/iphone.png');
            background-size: cover; background-position: center;
        }
        .mode-ipad .screen-container { background-image: url('https://quansbao.github.io/ipad.png'); }
        .mode-macbook .screen-container { background-image: url('https://quansbao.github.io/imac.png'); }
        .mode-imac .screen-container { background-image: url('https://quansbao.github.io/imac.png'); border-radius: 6px; height: var(--mac-h); }

        .aura-border {
            position: absolute; inset: -4px; border-radius: inherit;
            background: var(--ai-gradient); background-size: 200% 200%;
            opacity: 0; filter: blur(25px); z-index: -2; transition: opacity 1.2s ease;
        }
        .ai-active .aura-border { opacity: 0.5; animation: aurora-move 4s linear infinite; }

        @keyframes aurora-move { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .dynamic-island-wrapper {
            position: absolute; z-index: 800; top: 0; width: 100%;
            display: flex; justify-content: center; pointer-events: none;
            transition: all 0.6s var(--ios-easing);
        }
        
        .island-pill {
            background: #000; 
            position: relative; overflow: hidden;
            pointer-events: auto; display: flex; flex-direction: column; align-items: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: 
                width 0.6s var(--liquid-easing), 
                min-height 0.6s var(--liquid-easing), 
                border-radius 0.6s var(--liquid-easing), 
                background-color 0.5s ease,
                margin 0.6s var(--liquid-easing),
                box-shadow 0.6s ease,
                transform 0.6s var(--liquid-easing),
                opacity 0.6s var(--liquid-easing);
        }

        .mode-iphone .island-pill { width: 120px; height: 35px; min-height: 35px; border-radius: 20px; margin-top: 11px; }
        .mode-macbook .island-pill { width: 180px; height: 30px; min-height: 30px; margin-top: 0; border-radius: 0 0 12px 12px; }
        .mode-ipad .dynamic-island-wrapper { top: auto; bottom: 20px; }
        .mode-ipad .island-pill { width: 60px; height: 6px; min-height: 6px; background: rgba(255,255,255,0.4); margin: 0; border-radius: 10px; }
        
        .mode-imac .dynamic-island-wrapper { top: 35px; right: 25px; width: auto; justify-content: flex-end; left: auto; }
        .mode-imac .island-pill { width: 40px; height: 6px; min-height: 6px; background: rgba(0,0,0,0); opacity: 0; transform: translateX(200px); }

        .ai-active .island-pill {
            width: 340px; 
            min-height: 180px; 
            background: rgba(22, 22, 22, 0.85); 
            backdrop-filter: blur(50px) saturate(190%);
            -webkit-backdrop-filter: blur(50px) saturate(190%); 
            border: 1px solid rgba(255,255,255,0.12);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.7); 
            border-radius: 28px;
            margin-top: 20px;
            opacity: 1;
        }

        .mode-imac .ai-active .island-pill {
            margin-top: 0;
            width: var(--imac-w);
            min-height: var(--imac-h);
            transform: translate(var(--imac-x), var(--imac-y));
        }

        .drag-handle {
            display: none; width: 40px; height: 12px; position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            cursor: grab; z-index: 1001; padding: 10px;
        }
        .drag-handle::after { content: ''; display: block; width: 36px; height: 4px; background: rgba(255,255,255,0.2); border-radius: 10px; }
        .mode-imac .ai-active .drag-handle { display: flex; align-items: center; justify-content: center; }

        .resize-handle {
            display: none; position: absolute; right: 0; bottom: 0; width: 24px; height: 24px;
            cursor: nwse-resize; z-index: 1001;
        }
        .mode-imac .ai-active .resize-handle { display: block; }
        .resize-handle svg { width: 12px; height: 12px; position: absolute; bottom: 6px; right: 6px; fill: rgba(255,255,255,0.3); }

        .ai-content {
            opacity: 0; transform: translateY(10px); width: 100%; display: flex; flex-direction: column;
            padding: 22px; box-sizing: border-box; transition: opacity 0.4s 0.2s, transform 0.4s 0.2s; color: white;
            pointer-events: none;
        }
        .ai-active .ai-content { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .ai-header { display: flex; justify-content: space-between; align-items: center; font-size: 11px; font-weight: 600; color: rgba(255,255,255,0.4); text-transform: uppercase; margin-bottom: 16px; }
        .ai-visualizer { flex-shrink: 0; height: 3px; background: var(--ai-gradient); background-size: 200% 200%; border-radius: 10px; opacity: 0.4; animation: aurora-move 3s linear infinite; margin-bottom: 16px; }
        .ai-thinking .ai-visualizer { opacity: 1; height: 4px; animation: aurora-move 1s linear infinite; }
        .ai-response-area { font-size: 15px; color: rgba(255,255,255,0.95); max-height: 0; overflow: hidden; transition: max-height 0.5s var(--ios-easing), margin 0.5s; line-height: 1.5; }
        .has-response .ai-response-area { max-height: 350px; margin-bottom: 15px; overflow-y: auto; }
        .ai-input { background: transparent; border: none; outline: none; color: white; font-size: 19px; width: 100%; }
        .ai-input::placeholder { color: rgba(255,255,255,0.25); }

        .ripple-layer { position: absolute; inset: 0; pointer-events: none; z-index: 500; }
        .ripple-wave { position: absolute; width: 100px; height: 100px; border-radius: 50%; background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 70%); transform: translate(-50%, -50%) scale(0); opacity: 0; }
        .ripple-anim { animation: ripple-expand 1.2s var(--ios-easing) forwards; }
        @keyframes ripple-expand { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0.6; } 100% { transform: translate(-50%, -50%) scale(25); opacity: 0; } }

        /* --- Liquid Glass Dock --- */
        .dock-container { 
            position: fixed; 
            bottom: 30px; 
            display: flex; 
            gap: 12px; 
            z-index: 2000; 
            align-items: center;
            height: 76px;
            padding: 0 20px 8px 20px;
            border-radius: 34px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(45px) saturate(210%);
            -webkit-backdrop-filter: blur(45px) saturate(210%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-top: 1.5px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3), 0 20px 40px rgba(0, 0, 0, 0.6), inset 0 1px 0 rgba(255,255,255,0.1);
            transition: transform 0.3s ease;
        }

        .dock-btn { 
            background: rgba(255, 255, 255, 0.05); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            color: rgba(255,255,255,0.7); 
            width: 46px; height: 46px; border-radius: 13px; 
            cursor: pointer; 
            transition: background 0.2s, border-color 0.2s, transform 0.4s cubic-bezier(0.17, 0.89, 0.32, 1.25), margin 0.4s cubic-bezier(0.17, 0.89, 0.32, 1.25);
            display: flex; align-items: center; justify-content: center; transform-origin: bottom center; flex-shrink: 0; position: relative; margin-top: -8px;
        }

        .dock-btn::before { content: ''; position: absolute; top: 1px; left: 1px; right: 1px; height: 40%; background: linear-gradient(rgba(255,255,255,0.15), transparent); border-radius: 12px 12px 4px 4px; pointer-events: none; }
        .dock-btn::after { content: ''; position: absolute; bottom: -6px; width: 4px; height: 4px; background: #fff; border-radius: 50%; opacity: 0; transition: opacity 0.3s ease; }
        .dock-btn.is-active-app::after { opacity: 1; }
        .dock-btn svg { width: 22px; height: 22px; fill: currentColor; pointer-events: none; transition: transform 0.3s; }
        .dock-btn.active { background: rgba(255, 255, 255, 0.2); color: #fff; border-color: rgba(255,255,255,0.5); box-shadow: 0 4px 15px rgba(0,0,0,0.4); }
        .dock-btn:hover { transform: scale(1.8) translateY(-14px); background: rgba(255,255,255,0.3); color: #fff; margin-left: 18px; margin-right: 18px; z-index: 10; border-color: rgba(255,255,255,0.7); box-shadow: 0 10px 20px rgba(0,0,0,0.5); }
        .dock-btn.neighbor { transform: scale(1.35) translateY(-8px); margin-left: 8px; margin-right: 8px; }

        .power-btn-zone { position: absolute; background: #2a2a2a; border-radius: 4px; cursor: pointer; z-index: -1; }
        .mode-iphone .power-btn-zone { right: -4px; top: 180px; width: 6px; height: 60px; }
        .mode-ipad .power-btn-zone { top: -4px; right: 50px; width: 40px; height: 6px; }

    </style>
</head>
<body class="mode-iphone">

    <!-- Global Minimal Status Bar -->
    <div class="global-status-bar">
        <div class="ai-trigger-btn" onclick="toggleAIFromStatus()">
            <div class="ai-logo-glow"></div>
            <span style="font-weight: 600; font-size: 12px; opacity: 0.9;">Intelligence</span>
        </div>
        <div class="status-right">
            <span id="macTime">9:41 AM</span>
        </div>
    </div>

    <div class="viewport">
        <div class="device-wrapper" id="device">
            <div class="aura-border"></div>
            <div class="power-btn-zone" id="powerBtn"></div>

            <div class="screen-container">
                <div class="ripple-layer"><div class="ripple-wave" id="ripple"></div></div>
                <div class="dynamic-island-wrapper">
                    <div class="island-pill" id="island">
                        <div class="drag-handle" id="dragHandle"></div>
                        <div class="ai-content">
                            <div class="ai-header">
                                <span>Apple Intelligence</span>
                                <span style="opacity:0.6">Gemini Flash</span>
                            </div>
                            <div class="ai-visualizer"></div>
                            <div class="ai-response-area" id="aiResponse"></div>
                            <input type="text" class="ai-input" id="aiInput" placeholder="How can I help?">
                        </div>
                        <div class="resize-handle" id="resizeHandle">
                            <svg viewBox="0 0 24 24"><path d="M22 22h-2v-2h2v2zm0-4h-2v-2h2v2zm-4 4h-2v-2h2v2zm0-4h-2v-2h2v2zm-4 4h-2v-2h2v2zm8-8h-2v-2h2v2z"/></svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="dock-container" id="dock">
        <button class="dock-btn active is-active-app" title="iPhone" onclick="handleDockClick('iphone', this)">
            <svg viewBox="0 0 24 24"><path d="M17,1H7A2,2,0,0,0,5,3V21a2,2,0,0,0,2,2H17a2,2,0,0,0,2,-2V3A2,2,0,0,0,17,1Zm0,18H7V5H17ZM12,21a1,1,0,1,1,1,-1A1,1,0,0,1,12,21Z"/></svg>
        </button>
        <button class="dock-btn" title="iPad" onclick="handleDockClick('ipad', this)">
            <svg viewBox="0 0 24 24"><path d="M19,2H5A2,2,0,0,0,3,4V20a2,2,0,0,0,2,2H19a2,2,0,0,0,2,-2V4A2,2,0,0,0,19,2Zm0,16H5V6H19ZM12,21a1,1,0,1,1,1,-1A1,1,0,0,1,12,21Z"/></svg>
        </button>
        <button class="dock-btn" title="MacBook" onclick="handleDockClick('macbook', this)">
            <svg viewBox="0 0 24 24"><path d="M22,18H21V4a2,2,0,0,0,-2,-2H5A2,2,0,0,0,3,4V18H2a1,1,0,0,0,0,2H22a1,1,0,0,0,0,-2ZM5,4H19V18H5ZM12,19a0.5,0.5,0,1,1,0.5,-0.5A0.5,0.5,0,0,1,12,19Z"/></svg>
        </button>
        <button class="dock-btn" title="iMac" onclick="handleDockClick('imac', this)">
            <svg viewBox="0 0 24 24"><path d="M21,2H3A2,2,0,0,0,1,4V16a2,2,0,0,0,2,2H11v2H8a1,1,0,0,0,0,2h8a1,1,0,0,0,0,-2H13V18h8a2,2,0,0,0,2,-2V4A2,2,0,0,0,21,2Zm0,14H3V4H21Z"/></svg>
        </button>
    </div>

    <script>
        const device = document.getElementById('device');
        const powerBtn = document.getElementById('powerBtn');
        const ripple = document.getElementById('ripple');
        const island = document.getElementById('island');
        const input = document.getElementById('aiInput');
        const responseArea = document.getElementById('aiResponse');
        const dragHandle = document.getElementById('dragHandle');
        const resizeHandle = document.getElementById('resizeHandle');
        const dockBtns = Array.from(document.querySelectorAll('.dock-btn'));
        const macTime = document.getElementById('macTime');

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
            macTime.innerText = timeString;
        }
        setInterval(updateTime, 1000);
        updateTime();

        let holdTimer = null, isHeld = false, aiActive = false;
        let currentMode = 'iphone', isDeviceVisible = true;
        const apiKey = ""; 

        dockBtns.forEach((btn, idx) => {
            btn.addEventListener('mouseenter', () => {
                if (dockBtns[idx - 1]) dockBtns[idx - 1].classList.add('neighbor');
                if (dockBtns[idx + 1]) dockBtns[idx + 1].classList.add('neighbor');
            });
            btn.addEventListener('mouseleave', () => {
                dockBtns.forEach(b => b.classList.remove('neighbor'));
            });
        });

        let isDragging = false, isResizing = false;
        let startX, startY, startW, startH;
        let posX = 0, posY = 0, winW = 340, winH = 180;

        powerBtn.addEventListener('mousedown', startHold);
        document.addEventListener('mouseup', endHold);
        document.addEventListener('keydown', (e) => {
            if ((e.key === 'Alt' || e.key === 'Option') && !e.repeat) {
                const rect = device.getBoundingClientRect();
                startHold({ clientX: rect.left + rect.width/2, clientY: rect.bottom - 40 });
            }
            if (e.key === 'Enter' && aiActive && input.value.trim()) handleGeminiQuery(input.value.trim());
        });
        document.addEventListener('keyup', (e) => { if (e.key === 'Alt' || e.key === 'Option') endHold(); });

        dragHandle.addEventListener('mousedown', (e) => {
            if (currentMode !== 'imac') return;
            isDragging = true; startX = e.clientX - posX; startY = e.clientY - posY;
            island.style.transition = 'none'; e.stopPropagation();
        });

        resizeHandle.addEventListener('mousedown', (e) => {
            if (currentMode !== 'imac') return;
            isResizing = true; startX = e.clientX; startY = e.clientY;
            startW = winW; startH = winH;
            island.style.transition = 'none'; e.stopPropagation();
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                posX = e.clientX - startX; posY = e.clientY - startY;
                document.documentElement.style.setProperty('--imac-x', `${posX}px`);
                document.documentElement.style.setProperty('--imac-y', `${posY}px`);
            } else if (isResizing) {
                winW = Math.max(280, startW + (e.clientX - startX));
                winH = Math.max(150, startH + (e.clientY - startY));
                document.documentElement.style.setProperty('--imac-w', `${winW}px`);
                document.documentElement.style.setProperty('--imac-h', `${winH}px`);
            }
        });

        document.addEventListener('mouseup', () => { isDragging = isResizing = false; if (aiActive) island.style.transition = ''; });

        async function handleGeminiQuery(query) {
            input.value = ""; input.placeholder = "Thinking...";
            device.classList.add('ai-thinking');
            responseArea.innerText = "";
            device.classList.remove('has-response');
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ contents: [{ parts: [{ text: query }] }], systemInstruction: { parts: [{ text: "Short, crisp, Siri-like responses." }] } })
                });
                const data = await response.json();
                responseArea.innerText = data.candidates?.[0]?.content?.parts?.[0]?.text || "No response.";
                device.classList.add('has-response');
            } catch (err) {
                responseArea.innerText = "Connection lost.";
                device.classList.add('has-response');
            } finally {
                device.classList.remove('ai-thinking');
                input.placeholder = "How can I help?";
            }
        }

        function startHold(e) {
            if (aiActive || !isDeviceVisible) return;
            isHeld = true;
            let x = e.touches ? e.touches[0].clientX : e.clientX;
            let y = e.touches ? e.touches[0].clientY : e.clientY;
            holdTimer = setTimeout(() => { if (isHeld) invokeAI(x, y); }, 400);
        }

        function endHold() { isHeld = false; if (holdTimer) clearTimeout(holdTimer); }

        function toggleAIFromStatus() {
            if (aiActive) closeAI();
            else {
                const rect = device.getBoundingClientRect();
                invokeAI(rect.left + rect.width / 2, rect.top + 50);
            }
        }

        function invokeAI(originX, originY) {
            const screenRect = document.querySelector('.screen-container').getBoundingClientRect();
            ripple.style.left = `${originX - screenRect.left}px`;
            ripple.style.top = `${originY - screenRect.top}px`;
            ripple.classList.remove('ripple-anim');
            void ripple.offsetWidth;
            ripple.classList.add('ripple-anim');
            setTimeout(() => {
                aiActive = true;
                device.classList.add('ai-active');
                setTimeout(() => input.focus(), 500);
            }, 150);
        }

        document.addEventListener('mousedown', (e) => {
            if (aiActive && !e.target.closest('.island-pill') && !e.target.closest('.power-btn-zone') && !e.target.closest('.ai-trigger-btn')) closeAI();
        });

        function closeAI() {
            aiActive = false;
            device.classList.remove('ai-active');
            device.classList.remove('has-response');
            input.blur();
            posX = 0; posY = 0; winW = 340; winH = 180;
            document.documentElement.style.setProperty('--imac-x', `0px`);
            document.documentElement.style.setProperty('--imac-y', `0px`);
            document.documentElement.style.setProperty('--imac-w', `340px`);
            document.documentElement.style.setProperty('--imac-h', `180px`);
        }

        function handleDockClick(mode, btn) {
            if (mode === currentMode) { toggleGenie(); return; }
            switchDevice(mode, btn);
        }

        function toggleGenie() {
            isDeviceVisible = !isDeviceVisible;
            if (isDeviceVisible) device.classList.remove('genie-hidden');
            else { closeAI(); device.classList.add('genie-hidden'); }
        }

        function switchDevice(mode, btn) {
            isDeviceVisible = true;
            device.classList.remove('genie-hidden');
            device.classList.add('exit-left');
            setTimeout(() => {
                currentMode = mode;
                document.body.className = `mode-${mode}`;
                document.querySelectorAll('.dock-btn').forEach(b => { b.classList.remove('active', 'is-active-app'); });
                btn.classList.add('active', 'is-active-app');
                closeAI();
                device.classList.remove('exit-left');
                device.classList.add('enter-right');
                void device.offsetWidth;
                device.classList.remove('enter-right');
            }, 600);
        }
    </script>
</body>
</html>
